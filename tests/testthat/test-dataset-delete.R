context("Dataset delete")

source("helper-credentials.R")

test_that("delete_dataset", {
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_TESTU_ZIPPED")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_TESTU_ZIPPED")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_SQL_DATASOURCE_RAW_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_SQL_DATASOURCE_RAW_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_SQL_DATASOURCE_REQUEST_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_SQL_DATASOURCE_REQUEST_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_HIVE_DATASOURCE_RAW_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_HIVE_DATASOURCE_RAW_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_HIVE_DATASOURCE_REQUEST_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_HIVE_DATASOURCE_REQUEST_TESTU")
  # expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_HBASE_DATASOURCE_RAW_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_HBASE_DATASOURCE_RAW_TESTU")
  # expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_HDFS_DATASOURCE_RAW_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_HDFS_DATASOURCE_RAW_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_S3_DATASOURCE_RAW_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_S3_DATASOURCE_RAW_TESTU")
  # expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_SFTP_DATASOURCE_RAW_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_SFTP_DATASOURCE_RAW_TESTU")
  # expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_FTP_DATASOURCE_RAW_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_FTP_DATASOURCE_RAW_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_TEXT_SIM_ITEM_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_TEXT_SIM_ITEM_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_TEXT_SIM_QUERY_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_TEXT_SIM_QUERY_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_IMG_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_IMG_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_REGRESSION_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_REGRESSION_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_CLASSIFCICATION_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_CLASSIFCICATION_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_MULTICLASSIFICATION_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_MULTICLASSIFICATION_TESTU")
  expect(delete_dataset(get_project_id_from_name("PROJECT_TESTU"), get_dataset_id_from_name("DATASET_TIMESERIES_TESTU")) == 200, "delete_dataset() doesn't retrieve a 200 status code for DATASET_TIMESERIES_TESTU")
})
